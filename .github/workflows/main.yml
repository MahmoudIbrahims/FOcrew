name: ğŸ CI/CD Pipeline for FOcrew (Basic Python)

# ğŸš€ Triggers: Defines when this workflow will run
on:
  push:
    branches:
      - main
      - "release/**" # Runs on main and any branches starting with 'release'
    paths:
      - "src/**" # Only runs when files inside the src/ folder change
  pull_request:
    branches:
      - main

jobs:
  test_and_build:
    # âš™ï¸ Runner environment definition
    runs-on: ubuntu-latest
    
    # ğŸ“ Basic Environment Variables (optional but useful)
    env:
      PYTHON_VERSION: '3.10'
      
    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v4

      - name: ğŸ Setup Python ${{ env.PYTHON_VERSION }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          # caching: 'pip' # Uncomment to enable pip caching for faster installs

      - name: âš™ï¸ Install dependencies
        run: |
          # Upgrade pip
          python -m pip install --upgrade pip
          # Install dependencies from requirements.txt (or pyproject.toml)
          pip install -r src/requirements.txt
          # Install testing tools like pytest
          pip install pytest

      - name: âœ… Run tests
        # Assuming you have a tests/ folder and pytest is configured
        run: pytest

      - name: ğŸ“¦ Build/Package (Generate Source Distribution)
        # This command creates distribution files (sdist and wheel) 
        # and requires a pyproject.toml or setup.py file to be present.
        run: python -m build
        
      # Optional: Uncomment this section to upload the built package as an artifact
      # - name: â¬†ï¸ Upload build artifacts
      #   uses: actions/upload-artifact@v4
      #   with:
      #     name: fo_crew-package
      #     path: dist/
